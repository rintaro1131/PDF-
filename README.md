# 月末書類用PDF結合アプリ

月末の業務書類をまとめるためのセキュアなPDF結合ツールです。Content Security Policy（CSP）に完全対応し、シンプルで見やすいデザインを採用しています。

## 🔒 セキュリティ特徴

- **CSP完全対応**: `script-src 'self'` でインラインJS完全禁止
- **外部通信遮断**: `connect-src 'none'` でネットワーク通信なし
- **完全オフライン**: ブラウザ内処理のみ、データ外部送信なし

## 📁 ファイル構成

```
PDF結合アプリ/
├── index.html          # メインHTML（CSP対応）
├── app.css             # スタイルシート（外部ファイル）
├── app.js              # 全JavaScriptロジック（外部ファイル）
├── lib/
│   └── pdf-lib.min.js  # PDF処理ライブラリ（ベンダリング）
├── vercel.json         # Vercel用CSPヘッダ設定
└── README.md           # このファイル
```

## 🚀 使い方

### 1. ファイル選択
- **ファイル選択ボタン**: 複数のPDFファイルを選択
- **ドラッグ&ドロップ**: PDFファイルをドロップエリアに直接ドロップ
- PDF以外のファイルは自動的に無視され、無視件数が表示されます

### 2. 並べ替え
- ファイルリストの各行で操作可能：
  - **▲**: 上に移動
  - **▼**: 下に移動  
  - **×**: 削除
- 表示順序通りに結合されます

### 3. ファイル名設定
- **定型選択**: プルダウンから以下の定型ファイル名を選択
  - `20250月_名前_出勤簿`
  - `20250月_名前_身嗜手当`
  - `20250月_名前_社販手当`
  - `20250月_名前_報奨金`
  - `20250月__名前_立替金`
- **自由編集**: テキスト欄で自由にファイル名を編集可能
- プルダウン選択時、自動的にテキスト欄に反映され、フォーカス・カーソルが末尾に移動
- 拡張子 `.pdf` は自動付与

### 4. 結合・ダウンロード
- **結合実行**: 「結合してダウンロード」ボタンをクリック
- **エラー対応**: 暗号化・破損PDFは自動スキップして処理続行
- **成功条件**: 1ファイル以上成功すればダウンロード実行

## 🛡️ セキュリティ仕様

### Content Security Policy (CSP)
```
default-src 'self' blob:;
script-src 'self';
style-src 'self' 'unsafe-inline';
img-src 'self' blob:;
connect-src 'none';
frame-ancestors 'none';
base-uri 'none';
object-src 'none';
```

### 実装特徴
- **インラインJS禁止**: 全てのJavaScriptは外部ファイル（app.js）に分離
- **外部CDN禁止**: pdf-libをベンダリングして同梱
- **ネットワーク通信禁止**: connect-src 'none' で外部通信を完全遮断

## 💻 動作環境

- **ブラウザ**: Chrome、Firefox、Safari、Edge（モダンブラウザ）
- **ローカル実行**: `file://` プロトコルでも動作
- **本番環境**: Vercel等のCDN経由でも安全に動作

## ⚠️ 注意事項

### PDF処理について
- **暗号化PDF**: パスワード保護されたPDFは処理できません
- **破損ファイル**: 不正な形式のPDFはスキップされます
- **メモリ制限**: 大容量ファイルは処理に時間がかかる場合があります

### セキュリティについて
- **データ保護**: 全処理はブラウザ内で完結、外部送信なし
- **CSP準拠**: 本番環境でCSP違反エラーが発生しません
- **プライバシー**: ファイル内容は端末外に出ません

## 🔧 開発・デプロイ

### ローカル開発
```bash
# ローカルサーバー起動（任意）
python -m http.server 8000
# または file:// で直接開く
```

### Vercelデプロイ
```bash
git push origin main
# 自動デプロイ、CSPヘッダも自動適用
```

### 検証方法
1. ブラウザ開発者ツールのConsoleでCSP違反エラーがないことを確認
2. Networkタブで外部通信が発生していないことを確認
3. PDF結合機能が正常に動作することを確認

## 🎯 デザイン特徴

- **カードデザイン**: 白背景・角丸・薄い影の720px幅カード
- **ホバー効果**: ボタンやフォーム要素のインタラクティブなフィードバック
- **色分けステータス**: 成功(緑)・警告(橙)・エラー(赤)の視覚的表示
- **ドロップエリア**: 薄い背景色・ドラッグ時の青色ハイライト
- **注意書き**: エクセル・ワード使用不可を左ボーダー付きで表示

## 💻 簡単セットアップ

**ローカル使用**
```bash
# index.htmlを直接ブラウザで開く
open index.html
# または file:// でアクセス
```

**Vercelデプロイ**
```bash
# ビルド不要・GitHubから自動デプロイ
git push origin main
```

---

**🤖 Generated with Claude Code**